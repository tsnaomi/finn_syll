{% extends 'base.html' %}

{% block body %}
{{ modal() }}
<br>
<br> 

<div class='container'>
    {% if description %}
    <div class='description'>
        {% if kw == 'bad' %}
        This page lists words that have <i>imperfect</i> precision and recall.<br>
        This list excludes errors from variation, foreign words, bad compounds, /k/-deletions, and colloquialisms. 
        {% elif kw == 'variation' %}
        This pages lists words with <i>ambigious</i> test syllabifications that are not matched in the gold standard.
        {% elif kw == 'consonant-gradation' %}
        This pages lists words that exhibit <i>consonant gradation</i> (hand-verified).
        {% endif %}
        <br>
        <i>{{ count }} matches</i>
    </div>
    {% endif %}
    <div class='tokens'>
        {% if kw == 'variation' %} <!-- variation -->
        <form method='POST'>
            <input type='hidden' name='_csrf_token' value='{{ csrf_token() }}'>
            <div class='row hidden-xs hidden-sm'>
                <span class='attr-label col-md-1'>freq</span>
                <span class='attr-label col-md-3'>orth</span>
                <span class='col-md-5'>
                    <div class='row'>
                        <span class='attr-label col-md-5'>rules</span>
                        <span class='attr-label col-md-7'>test</span>
                    </div>
                </span>
                <span class='attr-label col-md-3'>gold</span>
            </div>
            <br class='hidden-xs hidden-sm'>
            {% for t in tokens %}
            <div class='row'>
                <input type='hidden' name='id_{{ loop.index }}' value='{{ t.id }}'> 
                <span class='col-xs-12 col-md-1'>
                    <span class='freq'>{{ t.freq }}</span>
                </span>
                <span class='col-xs-12 col-md-3'>
                    <span class='{{ t|goldclass }}' title='{{ title(t) }}'>{{ t.orth }}</span>
                </span>
                <span class='col-xs-12 col-md-5'>
                    <div class='row'>
                        <span class='col-xs-4 col-md-5'>{{ t.rules1 }}</span><span class='col-xs-8 col-md-7'>{{ t.test_syll1 }}</span>
                        {% if t.rules2 %}<div><span class='col-xs-4 col-md-5'>{{ t.rules2 }}</span><span class='col-xs-8 col-md-7'>{{ t.test_syll2 }}</span></div>
                        {% if t.rules3 %}<div><span class='col-xs-4 col-md-5'>{{ t.rules3 }}</span><span class='col-xs-8 col-md-7'>{{ t.test_syll3 }}</span></div>
                        {% if t.rules4 %}<div><span class='col-xs-4 col-md-5'>{{ t.rules4 }}</span><span class='col-xs-8 col-md-7'>{{ t.test_syll4 }}</span></div>
                        {% endif %}{% endif %}{% endif %}
                    </div>
                </span>
                <span class='col-xs-12 col-md-3'>
                    <input type='text' class='gray' name='syll1_{{ loop.index }}' placeholder='alternative syll' value='{{ t.test_syll1 }}'><br>
                    <input type='text' class='gray' name='syll2_{{ loop.index }}' placeholder='alternative syll' value='{{ t.test_syll2 }}'><br>
                    <input type='text' class='gray' name='syll3_{{ loop.index }}' placeholder='alternative syll' value='{{ t.test_syll3 }}'><br>
                    <input type='text' class='gray' name='syll4_{{ loop.index }}' placeholder='alternative syll' value='{{ t.test_syll4 }}'>
                </span>
            </div>
            <div class='row'>
                <span class='hidden-xs hidden-sm col-md-4'></span>
                <span class='col-xs-12 col-md-8'>
                    <textarea class='gray note' name='note_{{ loop.index }}' placeholder='Note...' >{{ t.note }}</textarea>
                </span>
            </div>
            <br>
            <br>
            {% endfor %}
            <div class='center'>
                <input type='submit' class='BIG OK' onclick="return confirm('Are you positive you want to approve these syllabifications?');" value='OK!'>
            </div>
        </form>
        {% else %} <!-- bad -->
        {{ tokenify(tokens) }}
        {% endif %}
    </div>
</div>
{% endblock %}

{% block footer %}
<script>
    function populatemodal(id, orth, lemma, gold, freq, pos, msd, rules1, rules2, rules3, rules4, test1, test2, test3, test4, syll1, syll2, syll3, syll4, precision, recall, note) {
        $('#orth').text(orth);
        $('#orth').attr('class', 'attr-orth ' + gold);
        $('#lemma').text(lemma);
        $('#freq').text(freq);
        $('#pos').text(pos);
        $('#msd').text(msd);
        $('#precision').text(precision);
        $('#recall').text(recall);
        $('#rules1').text(rules1);
        $('#rules2').text(rules2);
        $('#rules3').text(rules3);
        $('#rules4').text(rules4);
        $('#test1').text(test1);
        $('#test2').text(test2);
        $('#test3').text(test3);
        $('#test4').text(test4);
        if (gold == 'unverified') {
            $('#syll1').val(test1);
            $('#syll2').val(test2);
            $('#syll3').val(test3);
            $('#syll4').val(test4);
        } else {
            $('#syll1').val(syll1);
            $('#syll2').val(syll2);
            $('#syll3').val(syll3);
            $('#syll4').val(syll4);
        }
        $('#note').text(note.replace(/&#13;&#10;/g, '\r\n').replace(/&#40;/g, '(').replace(/&#41;/g, ')').replace(/&#34;/g, '"').replace(/&#39;/g, "'"));
        $('#id').val(id);
    }
</script>
{% endblock %}
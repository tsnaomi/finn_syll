{% extends 'base.html' %}

{% block body %}
{{ modal() }}
<br>
<br> 

<div class='container'>
    {% if description %}
    <div class='description'>
        {% if kw == 'variation' %}
        This page lists all of the words that display variation, whether in their <i>test</i> syllabifications, <i>gold</i> syllabifications, or both.
        {% elif kw == 'bad' %}
        This page lists all of the words that fail to have perfect <i>precision</i> and <i>recall</i>.
        {% elif kw == 'compounds' %}
        This page lists all of the <i>hand-annotated</i> compounds.
        {% elif kw == 'false-negative-compounds' %}
        This page lists all of the <i>hand-annotated compounds</i> that the syllabifier fails to predict are compounds (i.e., <i>false negatives</i>).
        {% elif kw == 'false-positive-compounds' %}
        This page lists all <i>syllabifier-predicted compounds</i> that are not true compounds (i.e., <i>false positives</i>).
        {% elif kw == 'simplex' %}
        This page lists all of the <i>hand-annotated</i> simplex words.
        {% elif kw == 'disagreement' %}
        This page lists all of the words that display annotator disagreement.
        {% endif %}
        <br>
        <i>{{ count }} matches</i>
    </div>
    {% endif %}
    <div class='tokens'>
        {% if kw == 'unverified' %} <!-- unverified -->
        <form method='POST'>
            <input type='hidden' name='_csrf_token' value='{{ csrf_token() }}'>
            <div class='row hidden-xs hidden-sm'>
                <span class='attr-label col-md-1'>freq</span>
                <span class='attr-label col-md-2'>orth</span>
                <span class='col-md-5'>
                    <div class='row'>
                        <span class='attr-label col-md-5'>rules</span>
                        <span class='attr-label col-md-7'>test</span>
                    </div>
                </span>
                <span class='attr-label col-md-3'>syll</span>
                <span class='attr-label col-md-1'>compound</span>
            </div>
            <br class='hidden-xs hidden-sm'>
            {% for t in tokens %}
            <div class='row'>
                <input type='hidden' name='id_{{ loop.index }}' value='{{ t.id }}'> 
                <span class='col-xs-12 col-md-1'>
                    <span class='freq'>{{ t.freq }}</span>
                </span>
                <span class='col-xs-12 col-md-2'>
                    <span class='{{ t|goldclass }}' title='{{ title(t) }}'>{{ t.orth }}</span>
                </span>
                <span class='col-xs-12 col-md-5'>
                    <div class='row'>
                        <span class='col-xs-4 col-md-5'>{{ t.rules1 }}</span><span class='col-xs-8 col-md-7'>{{ t.test_syll1 }}</span>
                        {% if t.rules2 %}<div><span class='col-xs-4 col-md-5'>{{ t.rules2 }}</span><span class='col-xs-8 col-md-7'>{{ t.test_syll2 }}</span></div>
                        {% if t.rules3 %}<div><span class='col-xs-4 col-md-5'>{{ t.rules3 }}</span><span class='col-xs-8 col-md-7'>{{ t.test_syll3 }}</span></div>
                        {% if t.rules4 %}<div><span class='col-xs-4 col-md-5'>{{ t.rules4 }}</span><span class='col-xs-8 col-md-7'>{{ t.test_syll4 }}</span></div>
                        {% endif %}{% endif %}{% endif %}
                    </div>
                </span>
                <span class='col-xs-12 col-md-3'>
                    <input type='text' class='gray' name='syll1_{{ loop.index }}' placeholder='alternative syll' value='{{ t.test_syll1 }}'><br>
                    <input type='text' class='gray' name='syll2_{{ loop.index }}' placeholder='alternative syll' value='{{ t.test_syll2 }}'><br>
                    <input type='text' class='gray' name='syll3_{{ loop.index }}' placeholder='alternative syll' value='{{ t.test_syll3 }}'><br>
                    <input type='text' class='gray' name='syll4_{{ loop.index }}' placeholder='alternative syll' value='{{ t.test_syll4 }}'>
                </span>
                <span class='col-xs-12 col-md-1'>
                    <input type='checkbox' id='compound' name='is_compound_{{ loop.index }}' value=1 {% if t.is_compound %} checked{% endif %}>
                    <span class='attr-label visible-xs visible-sm float-left'>compound&nbsp;&nbsp;</span>
                </span>
            </div>
            <div class='row'>
                <span class='hidden-xs hidden-sm col-md-3'></span>
                <span class='col-xs-12 col-md-9'>
                    <textarea class='gray note' name='note_{{ loop.index }}' placeholder='Note...' >{{ t.note }}</textarea>
                </span>
            </div>
            <br>
            <br>
            {% endfor %}
            <div class='center'>
                <input type='submit' class='BIG OK' onclick="return confirm('Are you positive you want to approve these syllabifications?');" value='OK!'>
            </div>
        </form>
        {% else %}
        {% if kw == 'notes' %} <!-- notes -->
        <div class='row hidden-xs hidden-sm'>
            <span class='attr-label col-md-3'>orth</span>
            <span class='attr-label col-md-3'>note</span>
        </div>
        <br class='hidden-xs hidden-sm'>
        {% for t in tokens %}
        <div class='row'>
            <span class='col-xs-12 col-md-3'>
                <span class='{{ t|goldclass }}' title='{{ title(t) }}' data-toggle='modal' data-target='#modal' onclick="{{ populate(t) }}">{{ t.orth }}</span>
            </span>
            <span class='col-xs-12 col-md-9' data-toggle='modal' data-target='#modal' onclick="{{ populate(t) }}">{{ t.note }}</span>
        </div>
        <br>
        {% endfor %}
        {% else %} <!-- bad, all variation, hidden -->
        {{ tokenify(tokens) }}
        {% endif %}
        {% endif %}
    </div>
</div>
{% endblock %}

{% block footer %}
<script>
    function populatemodal(id, orth, gold, freq, pos, msd, rules1, rules2, rules3, rules4, test1, test2, test3, test4, syll1, syll2, syll3, syll4, precision, recall, compound, stopword, foreign, note) {
        $('#orth').text(orth);
        $('#orth').attr('class', 'attr-orth ' + gold);
        $('#freq').text(freq);
        $('#pos').text(pos);
        $('#msd').text(msd);
        $('#precision').text(precision);
        $('#recall').text(recall);
        $('#rules1').text(rules1);
        $('#rules2').text(rules2);
        $('#rules3').text(rules3);
        $('#rules4').text(rules4);
        $('#test1').text(test1);
        $('#test2').text(test2);
        $('#test3').text(test3);
        $('#test4').text(test4);
        if (gold == 'unverified') {
            $('#syll1').val(test1);
            $('#syll2').val(test2);
            $('#syll3').val(test3);
            $('#syll4').val(test4);
        } else {
            $('#syll1').val(syll1);
            $('#syll2').val(syll2);
            $('#syll3').val(syll3);
            $('#syll4').val(syll4);
        };
        $('#note').text(note.replace(/&#13;&#10;/g, '\r\n').replace(/&#40;/g, '(').replace(/&#41;/g, ')').replace(/&#34;/g, '"').replace(/&#39;/g, "'"));
        $('#id').val(id);
        if (compound == 'True') {
            $('#compound').prop('checked', true);
        };
        if (stopword == 'True') {
            $('#stopword').prop('checked', true);
        };
        if (foreign == 'True') {
            $('#foreign').prop('checked', true);
        };
    }
</script>
{% endblock %}